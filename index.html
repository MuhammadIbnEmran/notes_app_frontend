<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>My Website</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
  <link href="https://getbootstrap.com/docs/5.3/assets/css/docs.css" rel="stylesheet">
</head>

<body class="p-3 m-0 border-0 bd-example m-0 border-0">
  <form id="noteForm">
    <div class="mb-3">
      <label for="author" class="form-label">
        Author:
      </label>
      <input type="text" id="author" name="author" class="form-control">
    </div>
    <div class="mb-3">
      <label for="note" class="form-label">
        Note:
      </label>
      <textarea id="note" rows="2" cols="25" name="note" class="form-control"></textarea>
    </div>
    <input type="submit" value="Submit" class="btn btn-primary">
  </form>
  <br>
  <button class="btn btn-primary" id="getNotesButton">
    Get Notes
  </button>
  <br>
  <div id="notesContainer">
<table class="table">
  <thead>
    <tr>
      <th scope="col">#</th>
      <th scope="col">Author</th>
      <th scope="col">Note</th>
      <th scope="col">Submitted Time</th>
    </tr>
  </thead>
  <tbody id="notesTable">

  </tbody>
</table>
  </div>
  <br>
  <a href="./get-notes.html">
    Link to Get Notes Page
  </a>
</body>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
  $("#noteForm").on("submit", function (e) {
    e.preventDefault(); // stop normal form submit

    const formData = $(this).serializeArray();
    const json = {};

    formData.forEach(field => {
      json[field.name] = field.value;
    });

    $.ajax({
      url: "http://localhost:8080/add-note",
      method: "POST",
      contentType: "application/json",
      data: JSON.stringify(json),
      success: function (response) {
        console.log("Success:", response);
      }
    });
  });

  $("#getNotesButton").on("click", function (e) {
    $.ajax({
      url: "http://localhost:8080/get-notes",
      method: "GET",
      contentType: "application/json",
      success: function (response) {
        console.log("Success:", response);
        for (var i = 0; i < response.length; i++){
          const noteRow = `<tr>
      <th scope="row">${i + 1}</th>
      <td>${response[i].author}</td>
      <td>${response[i].note}</td>
      <td>${response[i].submittedDateTime}</td>
    </tr>`;
          $("#notesTable").append(noteRow);
        }
      }
    });

  }); 
</script>

</html>